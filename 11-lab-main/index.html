<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Лабораторная №11: Список Задач (React)</title>
  
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f7f9; }
    #root { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); }
    h1 { color: #333; border-bottom: 2px solid #eee; padding-bottom: 10px; }
    input[type="text"] { padding: 10px; border: 1px solid #ddd; border-radius: 4px; width: 70%; margin-right: 10px; }
    button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    ul { list-style: none; padding: 0; }
    li { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px dashed #eee; }
    .delete-button { background-color: #dc3545; }
  </style>
</head>
<body>
  
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const LOCAL_STORAGE_KEY = 'react-lab11-tasks-full-html';

    // === TaskForm (Компонент формы) ===
    function TaskForm({ addTask }) {
      const [text, setText] = useState('');
      const handleSubmit = (e) => {
        e.preventDefault();
        if (text.trim() !== '') {
          addTask(text.trim());
          setText(''); 
        }
      };
      return (
        <form onSubmit={handleSubmit} style={{ marginBottom: '20px' }}>
          <input type="text" placeholder="Новая задача..." value={text} onChange={(e) => setText(e.target.value)}/>
          <button type="submit"> Добавить </button>
        </form>
      );
    }

    // === TaskList (Компонент списка) ===
    function TaskList({ tasks, removeTask }) {
      if (tasks.length === 0) {
        return <p>Список задач пуст. Добавьте первую задачу!</p>;
      }
      return (
        <ul>
          {tasks.map((t, i) => (
            <li key={i}>
              <span>{t}</span>
              <button className="delete-button" onClick={() => removeTask(i)}> Удалить </button>
            </li>
          ))}
        </ul>
      );
    }

    // === App (Главный компонент с LocalStorage) ===
    function App() {
      // 1. Инициализация состояния из LocalStorage
      const [tasks, setTasks] = useState(() => {
        const savedTasks = localStorage.getItem(LOCAL_STORAGE_KEY);
        return savedTasks ? JSON.parse(savedTasks) : [];
      });

      // 2. Эффект для сохранения данных при изменении
      useEffect(() => {
        localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(tasks));
      }, [tasks]);

      // Функции управления состоянием
      const addTask = (text) => setTasks((prevTasks) => [...prevTasks, text]);
      const removeTask = (index) => setTasks((prevTasks) => prevTasks.filter((_, i) => i !== index));

      return (
        <div>
          <h1> Список Задач (Lab 11)</h1>
          <TaskForm addTask={addTask} />
          <TaskList tasks={tasks} removeTask={removeTask} />
        </div>
      );
    }
    
    // Монтирование приложения
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);

  </script>
</body>
</html>